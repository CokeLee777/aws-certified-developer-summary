# Amazon EC2

- EC2는 AWS가 제공하는 서비스들 중 가장 인기있는 서비스중 하나이다.
- EC2 = Elastic Compute Cloud = Infrastructure as a Service

### EC2 Sizing & configuration options

- OS: Linux, Windows or Mac OS
- CPU
- Memory
- Storage
    - Network-attached(EBS & EFS)
    - hardware(EC2 Instace Store)
- Network card: 퍼블릭 IP 주소
- Firewall rules: 시큐리티 그룹
- 부트스트랩 스크립트: EC2 User Data

### EC2 User Data

- EC2 User Data를 사용하여 인스턴스가 시작될 때 실행될 스크립트를 지정할 수 있다.
- EC2 User Data는 자동화 boot 작업을 의미한다.
    - 업데이트 설치
    - 소프트웨어 설치 등

### EC2 Instance Types

m5.2xlarge

- m: instance class
- 5: generation
- 2xlarge: size within the instance class

### Security Group

- Security Group은 AWS의 기본적인 네트워크 시큐리티이다.
- 시큐리티 그룹은 EC2 인스턴스로 들어가는 트래픽(인바운드 트래픽)과 나가는 트래픽(아웃바운드 트래픽)을 제어한다.

### EC2 인스턴스 구매 옵션

- 온디맨드 인스턴스: 짧은 워크로드, 예측가능한 가격, 초 단위로 지불
- 예약 인스턴스(1~3년)
    - 긴 워크로드
- 절감형 플랜(1~3년): 사용량에 따라서 지불한다. 긴 워크로드에 적합하다.
- 스팟 인스턴스: 짧은 워크로드에 적합하다. 싸다. 하지만 인스턴스를 잃을 수 있다.
- 전용 호스트: 전체적인 물리적인 서버를 빌려주는 서비스이다. 인스턴스가 존재하는 장소를 제어할 수 있다.
- 전용 인스턴스: 인스턴스가 존재하는 장소도 공유하지 않고 내가 독자적으로 관리할 수 있다.
- 용량 예약: 특정 가용영역의 용량을 예약하는 인스턴스이다.

### EC2 On-Demand

- 내가 사용한 것에 대해서 지불
    - Linux & Windows - 첫 1분 뒤에부터 초단위로 계산한다.
    - 모든 다른 운영체제 - 시간단위로 지불한다.
- 가장 비싼 인스턴스이다.
- 긴 워크로드에 적합하다.
- 짧은 워크로드에 적합하다.

### EC2 Reserved Instances

- 온디맨드 인스턴스와 비교했을때 72% 까지의 할인율을 보여준다.
- 구체적인 인스턴스 구성을 예약할 수 있다.(인스턴스 타입, 지역, 운영체제 등)
- 예약은 1년과 3년을 선택할 수 있다.(1년에 비해서 3년치 예약 인스턴스가 더 저렴하다.)
- 예약 인스턴스는 지역 또는 가용영역별로 용량을 정할 수 있다.
- 지불 옵션은 - 후불, 부분 후불, 선불로 나뉘어지는데 선불에 가까울수록 더 저렴하게 지불할 수 있다.
- 지역 또는 가용영역 단위로 용량 예약을 할 수 있다.
- 정상 상태의 앱 사용에 추천하는 옵션이다.(데이터베이스)
- 예약 인스턴스 마켓플레이스에서 사거나 팔 수 있다.

### EC2 Savings Plans

- 긴 텀 베이스로된 할인을 제공받을 수 있다.(예약형 인스턴스와 동일하게 72%까지 할인이 가능하다.)
- 특정 인스턴스 그룹 또는 지역에 한해서 사용이 불가능하다.(us-east-1지역의 M5 클래스)
- 유연한 사용
    - 인스턴스 사이즈(m5.xlarge, m5.2xlarge)
    - OS(Linux, Windows)
    - Tenancy(Host, Dedicated, Default)

### EC2 Spot Instances

- 온디맨드와 비교했을 때 90%까지의 할인된 가격으로 이용할 수 있다.
- 현재 스팟 인스턴스의 가격보다 최대 가격이 낮은 경우 언제든지 내 인스턴스를 잃어버릴 수 있다.
- AWS에서 **가장 비용 효율적인 인스턴스**이다.
- 실패에 있어서 회복력이 있는 워크로드에 적합하다.
    - 배치 잡
    - 데이터 분석
    - 이미지 프로세싱
    - 어떤 분산 워크로드
    - 유연한 시작 또는 끝이 있는 워크로드
- 중요한 잡이나 데이터베이스에는 적합하지 않다.

### EC2 Dedicated Hosts

- EC2 인스턴스 용량을 완벽하게 사용할 수 있는 물리적 서버이다.
- 컴플라이언스 요구사항을 해결하고 **기존 서버 기반 소프트웨어 라이센스를 사용할 수 있다.**
- 구매 옵션은 다음과 같이 두 개가 존재
    - On-Demand
    - Reserved
- **가장 비싼 인스턴스 옵션**이다.
- 복잡한 라이센스 모델을 보유한 소프트웨어에 있어서 유용한 옵션이다.
- 또는 강력한 규정이나 컴플라이언스 요구사항이 있는 회사에 적합하다.

### EC2 Capacity Reservations

- 기간에 관계없이 특정 가용영역의 예약된 온디맨드 인스턴스를 이용하는 옵션이다.
- 내가 필요할 때마다 EC2 용량에 대해서 언제든지 액세스가 가능하다.
- 언제든지 생성하고, 취소가 가능하다. 할인율은 없다.
- 지역기반 예약 인스턴스와 절감형 플랜을 섞어서 사용 가능하다.
- 인스턴스가 실행중이든 아니든 온디맨드 가격에 대해서 지불해야 한다.
- 짧은 기간에 적합하고, 방해받지 않을 워크로드에 적합하다.
